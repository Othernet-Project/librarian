!function(a,b){function c(a,b){d.call(b)}function d(){var a=b(this),c=a.find(".tag-form");c.find("p:first").append(templates.closeTagButton),c.hide(),a.find(".tags").append(templates.tagButton)}function e(a){var c=b(this),d=c.parent(),e=d.next(".tag-form");d.hide(),e.show(),e.find("input").focus(),null!=m&&null!=m.masonry&&m.masonry()}function f(){var a=b(this),c=a.parents(".tag-form"),d=c.prev();c.hide(),d.show(),c.find("input").val(j(d)),null!=m&&null!=m.masonry&&m.masonry()}function g(a){var c,d=b(this),e=d.attr("action"),g=d.find("input").val(),k=d.prev(),l=d.find("button");a.preventDefault(),l.prop("disabled",!0),c=b.post(e,{tags:g,base_path:n.data("base-path")}),c.done(function(a){k.html(a+templates.tagButton),d.data("original",j(k)),f.call(l),h()}),c.fail(i),c.always(function(){l.prop("disabled",!1)})}function h(){n.length&&n.load(n.data("url")+"?tag="+n.data("current")+"&base_path="+n.data("base-path"))}function i(){alert(templates.tagsUpdateError)}function j(a){return a.find("a").map(function(){return b(this).text()}).get().join(", ")}{var k=b(a),l=b(document.body),m=b("#content-list"),n=b("#tag-cloud-container");b("#current-tag")}k.on("listUpdate",c),l.on("click",".tag-button",e),l.on("click",".tag-close-button",f),l.on("submit",".tag-form",g),d.call(l)}(this,jQuery),function(a,b){function c(a){j=k.height()}function d(a){var c,g,h,i;if(!t){if(t=!0,c=k.scrollTop(),g=l.height()-2*j,g>c)return void(t=!1);if(x+1>o)return q.show(),s.hide(),d=function(){},void(t=!1);w.p=x+=1,v.search(w),h=u+v.search(),s.hide(),p.show(),i=b.get(h),i.done(e),i.fail(f)}}function e(a){return a=b.trim(a),""===a?g():(a=b(a),n.append(a),p.hide(),s.show(),k.trigger("listUpdate",[a]),void(t=!1))}function f(){console.log("Not implemented")}function g(){console.log("Empty")}function h(){k.scrollTop()>j?r.fadeIn(200):r.fadeOut(200)}function i(a){a.preventDefault(),m.animate({scrollTop:0},500)}var j,k=b(a),l=b(document),m=b("html,body"),n=b("#content-list"),o=parseInt(n.data("total"),10),p=(b(".footer"),b(templates.loading)),q=b(templates.end),r=b(templates.toTop),s=b(templates.loadLink),t=!1,u=a.location.pathname,v=new URI(a.location.search),w=v.search(!0),x=parseInt(w.p,10),y=_.debounce(h,50);(null==x||isNaN(x)||Array.isArray(x))&&(x=1),isNaN(o)&&(o=1),o>1&&(n.after(s),s.on("click",d)),n.after(p),p.hide(),n.after(q),q.hide(),n.after(r),r.hide(),b(".to-top").click(i),c(),b(".pager-links").remove(),b(".paging").remove(),k.on("scroll",y),k.on("resize",c)}(this,jQuery);
//# sourceMappingURL=content.js.map